{# Données d'entrée :
- userModuleInvitation (ModueInvitation) Le ModuleInvitation de l'utilisateur connecté
- pollProposalForm (FormInterface) Le formulaire d'ajout/édition d'un PollProposal
- pp_form_modal_prefix (string) Le prefix utilisé pour identifier la modal
- edition (boolean) false si le formulaire concerne la création d'une nouvelle PollProposal
#}
{% if edition %}
    {{ form_start(pollProposalForm, { 'action' : path('pollProposalEditionForm', {'pollProposalId':pollProposalForm.id.vars.value,'moduleInvitationToken': userModuleInvitation.token}),
        'attr' : {'id': pp_form_modal_prefix~"_form_id"}}) }}
{% else %}
    {{ form_start(pollProposalForm, {'action':path('displayEvent',{'token':userModuleInvitation.module.event.token}),'attr':{'id': pp_form_modal_prefix~"_form_id"}}) }}
{% endif %}
<div>
    {{ form_label(pollProposalForm.pollProposalElements, null, {'label_attr':{'class':'sr-only'}}) }}
    {{ form_errors(pollProposalForm.pollProposalElements) }}

    {% for pollProposalElement in pollProposalForm.pollProposalElements %}
        {{ form_errors(pollProposalElement) }}
        {{ form_widget(pollProposalElement, {
            'widget_options':{
                'fgfloat':(pollProposalElement.valDatetime is not defined and pollProposalElement.valEndDatetime is not defined and pollProposalElement.picture is not defined),
                'fgline':true,
                'displayInRow':(pollProposalElement.valDatetime is defined or pollProposalElement.valEndDatetime is defined)}
        }) }}
        {% if false and pollProposalElement.picture is defined %}
            <script>
                $(document).ready(function () {
                    var fileInputOptions = {
                        {#uploadUrl: "{{ path('updateEventPicture', {"token":userEventInvitation.event.token}) }}",#}
                        browseOnZoneClick: false,
                        overwriteInitial: true,
                        maxFileSize: 2000,
                        showClose: false,
                        fileActionSettings: {
                            showUpload: false,
                            showZoom: false,
                            showDrag: false
                        },
                        showCaption: false,
                        browseLabel: '',
                        removeLabel: '',
                        uploadTitle: "{{ 'event.picture.update_modal.button.submit_title'|trans }}",
                        uploadLabel: "{{ 'global.button.save'|trans }}",
                        //browseIcon: '<i class="zmdi zmdi-folder"></i>',
                        //removeIcon: '<i class="zmdi zmdi-delete"></i>',
                        //removeTitle: 'Cancel or reset changes',
                        elErrorContainer: '#kv-avatar-errors-1',
                        msgErrorClass: 'alert alert-block alert-danger',
                        defaultPreviewContent: '<i class="zmdi zmdi-image-o zmdi-hc-5x"></i>',
                        layoutTemplates: {
                            main2: '{preview} <div class="text-center">{remove} {browse} {upload}</div>'
                        },
                        {#previewTemplates: {
                                image: '<div class="file-preview-frame" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}">\n' +
                                '   <div class="kv-file-content">' +
                                '       <div class="helper-tool-target">' +
                                '           <img src="{data}" class="kv-preview-data file-preview-image helper-tool-img" title="{caption}" alt="{caption}" style="max-height: 300px;">\n' +
                                '           <img class="reticle" src="{{ focuspointTarget }}">' +
                                '           <img src="{data}" class="kv-preview-data file-preview-image target-overlay" title="{caption}" alt="{caption}" style="max-height: 300px;">\n' +
                                '       </div>' +

                                '   </div>\n' +
                                /!*'   {footer}\n' +*!/
                                '</div>\n'
                            },#}
                        allowedFileExtensions: ["jpg", "jpeg", "png", "gif"]
                    };

                    {% if app.request.attributes.has('_locale') %}
                    fileInputOptions['language'] = '{{ app.request.attributes.get('_locale') }}';
                    {% endif %}

                    // initialize with defaults
                    {#$('#{{ pollProposalElement.picture.vars.id }}').fileinput(fileInputOptions)#}
                });
            </script>
        {% endif %}
    {% endfor %}
    {{ form_rest(pollProposalForm) }}
</div>

<div class="pull-right">
    <button type="button" class="btn btn-flat" data-dismiss="modal">{{ "global.button.cancel"|trans }}</button>
    <button type="submit" class="btn btn-primary">{{ "global.button.add"|trans }}</button>
</div>
{{ form_end(pollProposalForm) }}



