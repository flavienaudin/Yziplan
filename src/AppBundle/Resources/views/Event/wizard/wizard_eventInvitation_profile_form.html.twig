{% extends "@App/Event/partials/profile/eventInvitation_profile_form.html.twig" %}
{# Données d'entrée :
- userEventInvitation (EventInvitation) Invitation de l'utilisateur de l'utilisateur
- userEventInvitationForm (Form) Formulaire du profil de l'invité pour l'invitation
#}

{% block form_start %}
    {{ form_start(userEventInvitationForm, {'attr':{'id':userEventInvitationForm.vars.id}, 'action': path('wizardNewEventStep3', {'token':userEventInvitation.event.token})}) }}
{% endblock form_start %}

{% block action_buttons %}
    <div class="text-center">
        <a href="{{ path('wizardNewEventStep2',{'token':userEventInvitation.event.token}) }}" class="btn btn-flat m-b-10" role="button">{{ "global.button.previousStep"|trans }}</a>
        <button id="profile_form_submit" type="submit" class="btn {{ userEventInvitation.displayableName(false) is empty?"btn-primary":"btn-link b-1" }} m-b-10">
            {{ userEventInvitation.displayableName(false) is empty?"global.button.nextStep"|trans:"global.button.save"|trans }}</button>
    </div>
{% endblock action_buttons %}

{#<script>#}
    {% block submitEventInvitationProfileForm_succes %}
        $('.disabling-cover').remove();
    {% endblock submitEventInvitationProfileForm_succes %}

    {% block js_document_ready %}
    {% endblock js_document_ready %}
{#</script>#}

{#
{% block js_script %}
    {% use "@App/Event/partials/block/invitationUrl_copyClipboardInput.html.twig" %}
    {% set htmlInputBlock = block('inviationUrl_copyClipboardInput_block') %}
    <script>
        $(document).ready(function () {
            new Clipboard('#btn_copy_invitation_url');

            $('button#profile_form_submit').on("click", function (e) {
                var profileEmail = $('#{{ userEventInvitationForm.email.vars.id }}').val();
                if (profileEmail.trim() === "") {
                    e.preventDefault();
                    swal({
                        titleText: "{{ "eventInvitation.profile.card.guestemail_empty_alert.title"|trans }}",
                        html: '{{ htmlInputBlock|raw }}<br>{{ "eventInvitation.profile.card.guestemail_empty_alert.html"|trans }}',
                        input: "email",
                        showCancelButton: true,
                        buttonsStyling: false,
                        cancelButtonText: "{{ "eventInvitation.profile.card.guestemail_empty_alert.button.cancel"|trans }}",
                        cancelButtonClass: "btn btn-default btn-link btn-lg c-blue m-b-10 m-l-5 m-r-5",
                        confirmButtonText: "{{ "eventInvitation.profile.card.guestemail_empty_alert.button.confirm"|trans }}",
                        confirmButtonClass: "btn btn-primary btn-lg m-b-10  m-l-5 m-r-5",
                        animation: "slide-from-top",
                        inputPlaceholder: "{{ "eventInvitation.form.email.placeholder"|trans|raw }}"
                    }).then(function (inputValue) {
                        $('#{{ userEventInvitationForm.email.vars.id }}').val(inputValue);
                        $('form#{{ userEventInvitationForm.vars.id }}').submit();
                    }, function (dismiss) {
                        if (dismiss === 'cancel') {
                            $('form#{{ userEventInvitationForm.vars.id }}').submit();
                        }
                    });
                }
            });
        });
    </script>
{% endblock js_script %}
#}
