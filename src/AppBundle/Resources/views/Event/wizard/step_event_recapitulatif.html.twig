{% extends "@App/Event/wizard/new_event_wizard_page.html.twig" %}

{# Données d'entrée :
- event (Event) L'événement en cours de création
- userEventInvitation (EventInvitation) L'invitation à afficher (inclu l'événement concerné)
- userEventInvitationForm (Form) Formulaire permettant de répondre à l'invitation
- invitationsForm (Form|null) Formulaire permettant d'ajouter des emails
#}


{% block wizard_step_title %}{{ "event.wizard.recapitulatif.title"|trans }}
    <small>{{ "event.wizard.recapitulatif.subtitle.text"|trans }}<br>
    {% if not is_granted("IS_AUTHENTICATED_REMEMBERED") %}{{ "event.wizard.recapitulatif.subtitle.not_connected"|trans|raw }}{% endif %}</small>{% endblock %}

{% block wizard_step %}
    {{ include('@App/Event/wizard/wizard_eventInvitation_profile_form.html.twig', {"userEventInvitation":userEventInvitation, "userEventInvitationForm":userEventInvitationForm }) }}
{% endblock wizard_step %}

{% block wizard_step_post_card %}
    {% if event.template %}
        <div class="col-xs-12 col-xs-p-lr-0">
            <div class="card z-depth-1">
                {% if userEventInvitation.status is constant('AppBundle\\Utils\\enum\\EventInvitationStatus::AWAITING_VALIDATION') %}
                    <div class="disabling-cover animated"></div>
                {% endif %}
                <div class="card-header">
                    <h2>{{ "event.wizard.recapitulatif.template.title"|trans }}</h2>
                </div>
                <div class="card-body card-padding">
                    {% use "@App/Event/partials/block/templateDuplicationUrl_copyClipboardInput.html.twig" %}
                    {% set eventTemplateDuplicationUrlCopyClipboardBlock = block('event_template_duplication_url_copyClipboard_block') %}
                    <p>{{ "event.wizard.recapitulatif.template.paragraphe"|trans }}</p>
                    {{ eventTemplateDuplicationUrlCopyClipboardBlock|raw }}
                </div>
            </div>
        </div>
    {% else %}
        <div class="col-xs-12 col-xs-p-lr-0 {{ not userEventInvitation.event.invitationOnly?'col-sm-6' }}">
            <div class="card z-depth-1">
                {% if userEventInvitation.status is constant('AppBundle\\Utils\\enum\\EventInvitationStatus::AWAITING_VALIDATION') %}
                    <div class="disabling-cover animated"></div>
                {% endif %}
                <div class="card-header">
                    <h2>{{ 'event.wizard.recapitulatif.share_url.title'|trans }}</h2>
                </div>
                <div class="card-body card-padding">
                    <div>
                        {% if not event.template and invitationsForm is defined %}
                            {{ include('@App/Event/wizard/wizard_event_invitations_form.html.twig', {"userEventInvitation":userEventInvitation, "invitationsForm":invitationsForm }) }}
                        {% else %}
                            lien de duplication car template
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        {% if not userEventInvitation.event.invitationOnly %}
            <div class="col-xs-12 col-xs-p-lr-0 col-sm-6">
                <div class="card z-depth-1">
                    {% if userEventInvitation.status is constant('AppBundle\\Utils\\enum\\EventInvitationStatus::AWAITING_VALIDATION') %}
                        <div class="disabling-cover animated"></div>
                    {% endif %}
                    <div class="card-header">
                        <h2>{{ 'event.wizard.recapitulatif.share_url.title'|trans }}</h2>
                    </div>
                    <div class="card-body card-padding-sm">
                        {% use "@App/Event/partials/block/eventUrl_copyClipboardInput.html.twig" %}
                        {% set eventInvitationUrlCopyClipboardBlock = block('event_invitation_url_copyClipboard_block') %}
                        <div class="p-15">
                            {{ eventInvitationUrlCopyClipboardBlock|raw }}
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}
    {% endif %}

    <div class="col-xs-12 col-xs-p-lr-0">
        <div class="card z-depth-1">
            {% if userEventInvitation.status is constant('AppBundle\\Utils\\enum\\EventInvitationStatus::AWAITING_VALIDATION') %}
                <div class="disabling-cover animated"></div>
            {% endif %}
            <div class="card-body card-padding">
                <div class="text-center">
                    <a href="{{ path('wizardNewEventStep2',{'token':userEventInvitation.event.token}) }}" class="btn btn-flat m-b-10" role="button">{{ "global.button.previousStep"|trans }}</a> <a
                            href="{{ path('displayEvent',{'token':userEventInvitation.event.token}) }}" id="invitations_later" class="btn btn-primary f-700 m-b-10"
                            role="button">{{ "global.button.finish"|trans }}</a>
                </div>
                <div class="text-center c-gray">
                    <small>3/3</small>
                </div>
            </div>
        </div>
    </div>
{% endblock wizard_step_post_card %}


{% block top_javascripts %}
    {{ parent() }}
    <script src="{{ asset("bundles/app/js/selectize-standalone.min.js") }}"></script>
    <script src="{{ asset("bundles/app/js/yzi-selectize.js") }}"></script>
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset("bundles/app/css/selectize.bootstrap3.css") }}">
    <link rel="stylesheet" href="{{ asset("bundles/app/css/selectize.at.css") }}">

    <style>
        .disabling-cover {
            position: absolute;
            height: 100%;
            width: 100%;
            z-index: 10; /* make sure logout_box has a z-index of 2 */
            background-color: #000000;
            opacity: 0.5;
            display: block;
        }
    </style>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {# Plugin for cliplboard field (copy into clipboard by clicking) #}
    <script src="{{ asset('bundles/app/js/clipboard.min.js') }}"></script>
{% endblock javascripts %}

