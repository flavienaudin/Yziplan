{# Données d'entrée :
- userEventInvitation (EventInvitation) L'invitation de l'utilisateur "connecté"
- invitationsForm (Form|null) Formulaire permettant d'inviter (renseignement des e-mails des invités)
#}


<div class="card c-dark z-depth-1" id="eventInvitations-main-div">
    <div class="card-header palette-Teal bg m-b-10">
        <h2>{{ "invitations.display.title"|trans }}</h2>
    </div>
    <div class="card-body card-padding-sm" id="eventinvitation-body-card">
        {% if userEventInvitation.creator or userEventInvitation.administrator or (not userEventInvitation.event.invitationOnly and userEventInvitation.event.guestsCanInvite) %}
            <div class="m-t-10 fit-width" id="shareEventFB_container">
                <button class="btn btn-lg btn-block btn-facebook" id="shareEventFB" name="provider">
                    <i class="zmdi zmdi-facebook zmdi-hc-lg"></i> {{ "invitations.button.via_facebook"|trans }}
                </button>
            </div>
        {% endif %}
        {% if userEventInvitation.creator or userEventInvitation.administrator or userEventInvitation.event.guestsCanInvite %}
            <div class="m-t-10 fit-width">
                {{ include('@App/Contact/Gmail/Partials/load_gmail_contacts.html.twig', {'event' : userEventInvitation.event}) }}
            </div>
        {% endif %}

        {% if invitationsForm is not null %}
            <div class="m-t-10 palette-Teal-50 bg p-15">
                {{ include("@App/Event/partials/event_invitations_form.html.twig", { 'userEventInvitation':userEventInvitation, 'invitationsForm':invitationsForm}) }}
            </div>
        {% endif %}

        {% if userEventInvitation.creator or userEventInvitation.administrator or not userEventInvitation.event.invitationOnly %}
            <div id="event_public_invitation_display" class="m-t-10 palette-Teal-50 bg p-15">
                <div class="form-group animated">
                    <label class="control-label text-info" for="url_event_public_invitation">{{ "event.form.public_invitation.label"|trans }}</label>
                    <div class="input-group">
                        <input id="url_event_public_invitation" type="text" class="form-control" readonly="readonly" value="{{ url("displayEvent",{'token':userEventInvitation.event.token}) }}"> <span
                                class="input-group-btn">
                                <button type="button" id="btn_url_event_public_invitation" class="btn btn-primary" data-clipboard-target="#url_event_public_invitation">
                                    <i class="zmdi zmdi-copy"></i>{{ "global.button.copy"|trans }}</button>
                            </span>
                    </div>
                </div>
            </div>
        {% endif %}

    </div>
    <script>
        $(document).ready(function () {
            {% if userEventInvitation.creator or userEventInvitation.administrator %}
            {% if userEventInvitation.event.invitationOnly %}
            $('#event_public_invitation_display').hide();
            {% endif %}
            {% endif %}

            if (isMobile()) {
                $('#shareEventFB_container').remove();
            } else {
                // Initialize invitation via facebook
                $.ajaxSetup({cache: true});
                $.getScript('//connect.facebook.net/fr_FR/all.js', function () {
                    FB.init({
                        appId: {{ facebook_client_id }},
                        xfbml: true,
                        version: 'v2.8'
                    });
                });

                // React to the invite via facebook button
                $('#shareEventFB').click(function () {
                    var pageLink = $("#url_event_public_invitation").val();
                    FB.ui({
                        method: 'send',
                        link: pageLink
                    });
                });
            }
        });
    </script>
</div>

