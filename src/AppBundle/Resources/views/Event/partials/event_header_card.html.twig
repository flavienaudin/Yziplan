{# Données d'entrée :
- userEventInvitation (EventInvitation) L'invitation à afficher (inclu l'événement concerné)
- eventForm (Form|null) Formulaire d'édition des information général de l'événement (si les droits le permettent)
#}

<div class="card" id="event-header-card">
    {{ include('@App/Event/partials/event_header_card_header.html.twig', {'userEventInvitation':userEventInvitation, 'editEvent' : eventForm is not null }) }}

    <div class="card-body card-padding p-t-25">
        {% if eventForm is not null %}
            {{ form_start(eventForm, {'action':path('displayEvent',{'token':userEventInvitation.event.token}), 'attr':{'id':'eventHeader'}}) }}

            {{ form_row(eventForm.name, {
                'label':'event.form.name.label',
                'label_attr':{'class':'sr-only'},
                'attr':{'placeholder':'event.form.name.placeholder'},
                'fgline':true
            }) }}
            {{ form_row(eventForm.description, {
                'label':'event.form.description.label',
                'attr':{'placeholder':'event.form.description.placeholder','rows':3},
                'fgline':true
            }) }}
            {{ form_row(eventForm.responseDeadline, {
                'label':'event.form.responseDeadline.label',
                'label_attr':{'class':'sr-only'},
                'attr':{'placeholder':'event.form.responseDeadline.placeholder'},
                'fgline':true, 'displayInRow' : true
            }) }}

            {{ form_row(eventForm.invitationOnly, {'label':'event.form.invitationOnly.label','attr':{'class':'md-toogle-switch'}}) }}
            {{ form_row(eventForm.guestsCanInvite, {'label':'event.form.guestsCanInvite.label','attr':{'class':'md-toogle-switch'}}) }}
            {{ form_row(eventForm.guestsCanAddModule, {'label':'event.form.guestsCanAddModule.label','attr':{'class':'md-toogle-switch'}}) }}

            {{ form_rest(eventForm) }}
            <div class="text-right">
                <button type="submit" class="btn btn-primary waves-effect" data-loading-text="{{ "global.button.loading"|trans }}" data-original-text="{{ "global.button.save"|trans }}">
                    {{ "global.button.save"|trans }}
                </button>
            </div>
            {{ form_end(eventForm) }}
            <script>
                $('form#eventHeader').on("submit", function (e) {
                    ajaxFormSubmission(this, e, null, null, function () {
                        $('.grid').masonry('layout');
                    });
                });
                // Update the Event name while editing the form field
                $('#event_form_name').on('input', function () {
                   $('#event-name').html($(this).val());
                });
            </script>
        {% else %}
            <dl class="dl-horizontal">
                <dt>{{ "event.form.description.label"|trans }}</dt>
                <dd>{{ userEventInvitation.event.description }}</dd>
                <dt>{{ "event.form.responseDeadline.label"|trans }}</dt>
                <dd>{{ userEventInvitation.event.responseDeadline|localizeddate }}</dd>
                <dt></dt>
                <dd>
                    {% if event.invitationOnly %}
                        <div class="text-danger">
                            <i class="zmdi zmdi-close-circle"></i> {{ "event.form.invitationOnly.text.true"|trans }}
                        </div>
                    {% else %}
                        <div class="text-success">
                            <i class="zmdi zmdi-check"></i> {{ "event.form.invitationOnly.text.false"|trans }}
                        </div>
                    {% endif %}
                </dd>
                <dt></dt>
                <dd>
                    {% if event.guestsCanInvite %}
                        <div class="text-success">
                            <i class="zmdi zmdi-check"></i> {{ "event.form.guestsCanInvite.text.true"|trans }}
                        </div>
                    {% else %}
                        <div class="text-danger">
                            <i class="zmdi zmdi-close-circle"></i> {{ "event.form.guestsCanInvite.text.false"|trans }}
                        </div>
                    {% endif %}
                </dd>
                <dt></dt>
                <dd>
                    {% if event.guestsCanAddModule %}
                        <div class="text-success">
                            <i class="zmdi zmdi-check"></i> {{ "event.form.guestsCanAddModule.text.true"|trans }} (à garder ?)
                        </div>
                    {% else %}
                        <div class="text-danger">
                            <i class="zmdi zmdi-close-circle"></i> {{ "event.form.guestsCanAddModule.text.false"|trans }} (à garder ?)
                        </div>
                    {% endif %}
                </dd>
            </dl>
        {% endif %}
    </div>
</div>